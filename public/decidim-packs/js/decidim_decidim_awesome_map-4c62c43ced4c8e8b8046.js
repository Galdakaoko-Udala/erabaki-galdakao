!function(){var e,t={12097:function(){L.TileLayer.HERE=L.TileLayer.extend({options:{subdomains:"1234",minZoom:2,maxZoom:18,scheme:"normal.day",resource:"maptile",mapId:"newest",format:"png8",appId:"",appCode:"",useCIT:!1,useHTTPS:!0,language:"",language2:""},initialize:function(e){var t=(e=L.setOptions(this,e)).scheme.split(".")[0];e.tileResolution=256;var n=["apiKey="+encodeURIComponent(e.apiKey)];e.apiKey||(n=["app_id="+encodeURIComponent(e.appId),"app_code="+encodeURIComponent(e.appCode)]),e.language&&n.push("lg="+encodeURIComponent(e.language)),e.language2&&n.push("lg2="+encodeURIComponent(e.language2));var o="/maptile/2.1/{resource}/{mapId}/{scheme}/{z}/{x}/{y}/{tileResolution}/{format}"+("?"+n.join("&")),r="/maptile/2.1/copyright/{mapId}?apiKey={apiKey}",a="maps.ls.hereapi.com";e.apiKey||(a="maps"+(e.useCIT?".cit":"")+".api.here.com",r="/maptile/2.1/copyright/{mapId}?app_id={appId}&app_code={appCode}");var i="base."+a;"satellite"!=t&&"terrain"!=t&&"hybrid"!=t||(i="aerial."+a),-1!==e.scheme.indexOf(".traffic.")&&(i="traffic"+a);var s="http"+(e.useHTTPS?"s":""),c=s+"://{s}."+i+o;this._attributionUrl=L.Util.template(s+"://1."+i+r,this.options),L.TileLayer.prototype.initialize.call(this,c,e),this._attributionText=""},onAdd:function(e){L.TileLayer.prototype.onAdd.call(this,e),this._attributionBBoxes||this._fetchAttributionBBoxes()},onRemove:function(e){this._map.attributionControl.removeAttribution(this._attributionText),this._attributionText="",this._map.off("moveend zoomend resetview",this._findCopyrightBBox,this),L.TileLayer.prototype.onRemove.call(this,e)},_fetchAttributionBBoxes:function(){var e=new XMLHttpRequest;e.onreadystatechange=L.bind((function(){4==e.readyState&&200==e.status&&this._parseAttributionBBoxes(JSON.parse(e.responseText))}),this),e.open("GET",this._attributionUrl,!0),e.send()},_parseAttributionBBoxes:function(e){if(this._map){for(var t=e[this.options.scheme.split(".")[0]]||e.normal,n=0;n<t.length;n++)if(t[n].boxes)for(var o=0;o<t[n].boxes.length;o++){var r=t[n].boxes[o];t[n].boxes[o]=L.latLngBounds([[r[0],r[1]],[r[2],r[3]]])}this._map.on("moveend zoomend resetview",this._findCopyrightBBox,this),this._attributionProviders=t,this._findCopyrightBBox()}},_findCopyrightBBox:function(){if(this._map){for(var e=this._attributionProviders,t=[],n=this._map.getZoom(),o=this._map.getBounds(),r=0;r<e.length;r++)if(e[r].minLevel<=n&&e[r].maxLevel>=n)if(e[r].boxes)for(var a=0;a<e[r].boxes.length;a++){var i=e[r].boxes[a];if(o.intersects(i)){t.push(e[r]);break}}else t.push(e[r]);var s=['<a href="https://legal.here.com/en-gb/terms" target="_blank" rel="noopener noreferrer">HERE maps</a>'];for(r=0;r<t.length;r++){var c=t[r];s.push('<abbr title="'+c.alt+'">'+c.label+"</abbr>")}var l="\xa9 "+s.join(", ")+". ";l!==this._attributionText&&(this._map.attributionControl.removeAttribution(this._attributionText),this._map.attributionControl.addAttribution(this._attributionText=l))}}}),L.tileLayer.here=function(e){return new L.TileLayer.HERE(e)}},2770:function(e,t,n){"use strict";var o=n(45243),r=n(48782);L.DivIcon.SVGIcon=r.q,L.DivIcon.SVGIcon.DecidimIcon=L.DivIcon.SVGIcon.extend({options:{fillColor:"#ef604d",opacity:0},_createPathDescription:function(){return"M14 1.17a11.685 11.685 0 0 0-11.685 11.685c0 11.25 10.23 20.61 10.665 21a1.5 1.5 0 0 0 2.025 0c0.435-.435 10.665-9.81 10.665-21A11.685 11.685 0 0 0 14 1.17Zm0 17.415A5.085 5.085 0 1 1 19.085 13.5 5.085 5.085 0 0 1 14 18.585Z"},_createCircle:function(){return""},_createSVG:function(){var e=this._createPath(),t=this._createCircle(),n=this._createText(),o="".concat(this.options.className,"-svg"),r="width:".concat(this.options.iconSize.x,"px; height:").concat(this.options.iconSize.y,"px;");return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="'.concat(o,'" style="').concat(r,'">').concat(e).concat(t).concat(n,"</svg>")}});n(12097),n(95732),n(54183),n(91322),n(62743);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===a(i)?i:String(i)),o)}var r,i}var s=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.awesomeMap=t,this.main=o.control.layers(null,null,{position:"topleft",sortLayers:!1,collapsed:this.awesomeMap.config.collapsedMenu}),this.awesomeMap.config.hideControls&&$(this.main.getContainer()).hide(),this.$loading=$("#awesome-map .loading-spinner"),this.onHashtag=this._orderHashtags,this.awesomeMap.map.on("overlayadd",(function(){n.removeHiddenCategories()}))}var t,n,r;return t=e,(n=[{key:"attach",value:function(){var e=this;this.main.addTo(this.awesomeMap.map),this.addSearchControls(),this.awesomeMap.config.menu.categories&&this.addCategoriesControls(),$("#awesome-map").on("click",".awesome_map-title-control",(function(e){e.preventDefault(),e.stopPropagation(),$("#awesome_map-categories-control").toggleClass("active"),$("#awesome_map-hashtags-control").toggleClass("active")})),$("#awesome-map").on("change",".awesome_map-hashtags-selector",(function(t){t.preventDefault(),t.stopPropagation(),$(t.target).closest("label").data("layer")&&e.updateHashtagLayers()})),$("#awesome-map").on("click",".awesome_map-toggle_all_tags",(function(t){t.preventDefault(),t.stopPropagation(),$("#awesome-map .awesome_map-hashtags-selector").prop("checked",$("#awesome-map .awesome_map-hashtags-selector:checked").length<$("#awesome-map .awesome_map-hashtags-selector").length),e.updateHashtagLayers()}))}},{key:"addSearchControls",value:function(){$(this.main.getContainer()).contents("form").append('<div id="awesome_map-categories-control" class="active"><b class="awesome_map-title-control">'.concat(window.DecidimAwesome.texts.categories,'</b><div class="categories-container"></div></div>\n    <div id="awesome_map-hashtags-control"><b class="awesome_map-title-control">').concat(window.DecidimAwesome.texts.hashtags,'</b><div class="hashtags-container"></div><a href="#" class="awesome_map-toggle_all_tags">').concat(window.DecidimAwesome.texts.select_deselect_all,"</a></div>"))}},{key:"addCategoriesControls",value:function(){var e=this;this.awesomeMap.categories.forEach((function(t){var n='<i class="awesome_map-category_'.concat(t.id,'"></i> ').concat(t.name);e.awesomeMap.layers[t.id]={label:n,group:new o.FeatureGroup.SubGroup(e.awesomeMap.cluster)},e.awesomeMap.layers[t.id].group.addTo(e.awesomeMap.map),$("#awesome_map-categories-control .categories-container").append('<label data-layer="'.concat(t.id,'" class="awesome_map-category-').concat(t.id).concat(t.parent?" subcategory":"",'" data-parent="').concat(t.parent,'"><input type="checkbox" class="awesome_map-categories-selector" checked><span>').concat(n,"</span></label>"))})),$("#awesome-map").on("change",".awesome_map-categories-selector",(function(t){t.preventDefault(),t.stopPropagation();var n=$(t.target).closest("label").data("layer"),o=e.awesomeMap.getCategory(n);if(o){var r=e.awesomeMap.layers[o.id];t.target.checked?e.awesomeMap.map.addLayer(r.group):e.awesomeMap.map.removeLayer(r.group),e._indeterminateParentInput(o),e.updateHashtagLayers()}}))}},{key:"addHashtagsControls",value:function(e,t){var n=this;e&&e.length&&($("#awesome_map-hashtags-control").show(),e.forEach((function(e){n.awesomeMap.layers[e.tag]||(n.awesomeMap.layers[e.tag]={label:e.name,group:new o.FeatureGroup.SubGroup(n.awesomeMap.cluster)},n.awesomeMap.map.addLayer(n.awesomeMap.layers[e.tag].group),$("#awesome_map-hashtags-control .hashtags-container").append('<label data-layer="'.concat(e.tag,'" class="awesome_map-hashtag-').concat(e.tag,'"><input type="checkbox" class="awesome_map-hashtags-selector" checked><span>').concat(e.name,"</span></label>")),n.onHashtag(e,$("#awesome_map-hashtags-control .hashtags-container"))),n.awesomeMap.layers[e.tag].group.addLayer(t);var r=$("label.awesome_map-hashtag-".concat(e.tag));r.attr("title","".concat(parseInt(r.attr("title")||0,10)+1," ").concat(window.DecidimAwesome.texts.items))})))}},{key:"showCategory",value:function(e){$("#awesome_map-categories-control").show();var t=$("label.awesome_map-category-".concat(e.id)),n=$("label.awesome_map-category-".concat(e.parent));t.show(),t.attr("title","".concat(parseInt(t.attr("title")||0,10)+1," ").concat(window.DecidimAwesome.texts.items)),n.show(),n.attr("title","".concat(parseInt(n.attr("title")||0,10)+1," ").concat(window.DecidimAwesome.texts.items))}},{key:"removeHiddenComponents",value:function(){var e=this;$(".awesome_map-component").each((function(t,n){var o=e.awesomeMap.layers[$(n).data("layer")],r=$(n).closest("div").find("input:not(:checked)");o&&r.length&&(e.awesomeMap.map.addLayer(o.group),e.awesomeMap.map.removeLayer(o.group))}))}},{key:"removeHiddenCategories",value:function(){var e=this;$(".awesome_map-categories-selector:not(:checked)").each((function(t,n){var o=e.awesomeMap.layers[$(n).closest("label").data("layer")];o&&(e.awesomeMap.map.addLayer(o.group),e.awesomeMap.map.removeLayer(o.group))}))}},{key:"updateHashtagLayers",value:function(){var e=this;$(".awesome_map-hashtags-selector").each((function(t,n){var o=e.awesomeMap.layers[$(n).closest("label").data("layer")];o&&e.awesomeMap.map.removeLayer(o.group)})),$(".awesome_map-hashtags-selector:checked").each((function(t,n){var o=e.awesomeMap.layers[$(n).closest("label").data("layer")];o&&e.awesomeMap.map.addLayer(o.group)})),this.removeHiddenComponents(),this.removeHiddenCategories()}},{key:"updateStats",value:function(e,t){$("#awesome_map-".concat(e)).attr("title","".concat(t," ").concat(window.DecidimAwesome.texts.items))}},{key:"_indeterminateParentInput",value:function(e){if(e.parent){var t=$(".awesome_map-category-".concat(e.parent)).contents("input"),n=$('[class^="awesome_map-category-"][data-parent="'.concat(e.parent,'"]:visible')),o=n.contents("input:checked").length;t.prop("indeterminate",o!==n.length&&0!==o)}}},{key:"_orderHashtags",value:function(e,t){var n=t.contents("label:last");n.prev("label").length&&t.contents("label").each((function(e,t){$(t).text().localeCompare(n.text())>0&&$(t).before(n)}))}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===c(a)?a:String(a)),o)}var r,a}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.awesomeMap=t,this.component=n,this.templateId="marker-meeting-popup",this.controls={label:this.getLabel(),group:new o.FeatureGroup.SubGroup(this.awesomeMap.cluster)},this.onFinished=function(){},this.allNodes=[]}var t,n,r;return t=e,n=[{key:"getLabel",value:function(){var e=this.awesomeMap.config.menu.mergeComponents||this.component.name;return e||(e=window.DecidimAwesome.texts[this.component.type]),'<span class="awesome_map-component" id="awesome_map-component_'.concat(this.component.id,'" title="0" data-layer="').concat(this.component.type,'">').concat(e,"</span>")}},{key:"setFetcher",value:function(e){var t=this;this.fetcher=new e(this),this.fetcher.onFinished=function(){t._onFinished()},this.fetcher.onCollection=function(e){if(e&&e.edges){var n=[];n="meetings"===t.fetcher.collection?e.edges.filter((function(e){return e.node.coordinates&&e.node.coordinates.latitude&&e.node.coordinates.longitude})):e.edges.filter((function(e){return e.node.coordinates&&e.node.coordinates.latitude&&e.node.coordinates.longitude&&(n=e.node,o=t.awesomeMap,r=o.config.show,a=r.withdrawn,i=r.accepted,s=r.evaluating,c=r.notAnswered,l=r.rejected,a&&"withdrawn"===n.state||i&&"accepted"===n.state||s&&"evaluating"===n.state||c&&"notAnswered"===n.state||l&&"rejected"===n.state);var n,o,r,a,i,s,c,l}));try{t.awesomeMap.cluster.addLayers(n.map((function(e){return e.node.marker})))}catch(o){console.error("Failed marker collection assignation",n,"error",o)}n.forEach((function(e){t.awesomeMap.layers[t.component.type].group.addLayer(e.node.marker),t.addMarkerCategory(e.node.marker,e.node.category),t.addMarkerHashtags(e.node.marker,e.node.hashtags)}))}}}},{key:"addControls",value:function(){this.awesomeMap.controls.main.addOverlay(this.controls.group,this.controls.label),this.controls.group.addTo(this.awesomeMap.map),this.awesomeMap.layers[this.component.type]=this.controls}},{key:"loadNodes",value:function(){}},{key:"addMarker",value:function(e,t){var n=this;e.on("click",(function(){var r=document.createElement("div");r.innerHTML=$.templates("#".concat(n.templateId)).render(t);var a=o.popup({maxwidth:640,minWidth:500,keepInView:!0,className:"map-info"}).setLatLng(e.getLatLng()).setContent(r);n.awesomeMap.map.addLayer(a)})),t.marker=e,t.component=this.component,this.allNodes.push(t)}},{key:"addMarkerCategory",value:function(e,t){var n=this.awesomeMap.getCategory(t);if(this.awesomeMap.layers[n.id])try{this.awesomeMap.layers[n.id].group.addLayer(e),this.awesomeMap.controls.showCategory(n)}catch(o){console.error("Failed category marker assignation",e,o.message)}}},{key:"addMarkerHashtags",value:function(e,t){if(this.awesomeMap.config.menu.hashtags)try{this.awesomeMap.controls.addHashtagsControls(t,e)}catch(n){console.error("Failed hashtags marker assignation",e,n.message)}}},{key:"_onFinished",value:function(){this.awesomeMap.controls.updateStats("component_".concat(this.component.id),this.allNodes.length),this.onFinished()}},{key:"createIcon",value:function(e,t){return new e({color:"#000000",fillColor:t,circleFillColor:t,weight:1,stroke:t,fillOpacity:.9})}}],n&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===p(a)?a:String(a)),o)}var r,a}var m=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.query=t,this.variables=n}var t,n,o;return t=e,(n=[{key:"fetch",value:function(e){$.ajax({method:"POST",url:"/api",contentType:"application/json",data:JSON.stringify({query:this.query,variables:this.variables})}).done((function(t){e(t.data)}))}},{key:"fetchAll",value:function(e){this.fetch(e)}}])&&f(t.prototype,n),o&&f(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==d(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===d(a)?a:String(a)),o)}var r,a}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=t,this.config={length:t.awesomeMap.config.length||255},this.onFinished=function(){},this.onNode=function(){},this.onCollection=function(){},this.hashtags=[],this.collection=this.controller.component.type,this.query="query ($id: ID!, $after: String!) {\n        component(id: $id) {\n          id\n          __typename\n        }\n      }"}var t,n,o;return t=e,n=[{key:"fetch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={id:this.controller.component.id,after:t};new m(this.query,n).fetchAll((function(t){if(t){var n=t.component[e.collection];n.edges.forEach((function(t){var n=t.node;n&&n.coordinates&&n.coordinates.latitude&&n.coordinates.longitude&&(e.decorateNode(n),e.onNode(n))})),e.onCollection(n),n.pageInfo.hasNextPage?e.fetch(n.pageInfo.endCursor):e.onFinished()}}))}},{key:"decorateNode",value:function(e){var t=this.findTranslation(e.body.translations),n=this.findTranslation(e.title.translations);e.hashtags=this.collectHashtags(n),e.hashtags=e.hashtags.concat(this.collectHashtags(t)),e.title.translation=this.replaceHashtags(n,e.hashtags),e.body.translation=this.appendHtmlHashtags(this.truncate(this.removeHashtags(t)).replace(/\n/g,"<br>"),e.hashtags),e.link="".concat(this.controller.component.url,"/").concat(this.collection,"/").concat(e.id)}},{key:"findTranslation",value:function(e){var t=document.querySelector("html").getAttribute("lang"),n="";return e.forEach((function(e){e.text&&(n&&e.locale!==t||(n=e.text))})),n}},{key:"collectHashtags",value:function(e){var t=this,n=[];if(e){var o=e.match(/gid:\/\/[^\s<&]+/g);o&&(n=o.filter((function(e){return-1!==e.indexOf("/Decidim::Hashtag/")})).map((function(e){var n=e.split("/"),o="_"===n[5].charAt(0),r=o?n[5].substr(1):n[5],a="#".concat(r),i='<a href="/search?term='.concat(a,'">').concat(a,"</a>"),s={color:getComputedStyle(document.documentElement).getPropertyValue("--secondary"),gid:e,id:parseInt(n[4],10),fromSelector:o,tag:r,name:a,html:i};return t.hashtags.push(s),s})))}return n}},{key:"replaceHashtags",value:function(e,t){var n=e;return t.forEach((function(e){n=n.replace(e.gid,e.name)})),n}},{key:"removeHashtags",value:function(e){return e.replace(/gid:\/\/[^\s<&]+/g,"")}},{key:"appendHtmlHashtags",value:function(e,t){var n=e;return t.forEach((function(e){n+=" ".concat(e.html)})),n}},{key:"truncate",value:function(e){return $.truncate(e,this.config)}}],n&&h(t.prototype,n),o&&h(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==g(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===g(a)?a:String(a)),o)}var r,a}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_(e);if(t){var r=_(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===g(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var S=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(a,e);var t,n,o,r=w(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).query="query ($id: ID!, $after: String!) {\n      component(id: $id) {\n          id\n          __typename\n          ... on Proposals {\n            proposals(first: 50, after: $after){\n              pageInfo {\n                hasNextPage\n                endCursor\n              }\n              edges {\n                node {\n                  id\n                  state\n                  title {\n                    translations {\n                      text\n                      locale\n                    }\n                  }\n                  body {\n                    translations {\n                      text\n                      locale\n                    }\n                  }\n                  address\n                  coordinates {\n                    latitude\n                    longitude\n                  }\n                  amendments {\n                    emendation {\n                      id\n                    }\n                  }\n                  category {\n                    id\n                  }\n                }\n              }\n            }\n          }\n        }\n      }",t}return t=a,n&&v(t.prototype,n),o&&v(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(y);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function O(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==k(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===k(a)?a:String(a)),o)}var r,a}function C(){return C="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},C.apply(this,arguments)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=P(e);if(t){var r=P(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var x=o.DivIcon.SVGIcon.DecidimIcon.extend({options:{fillColor:"#ef604d",fillOpacity:.8,strokeWidth:1,strokeOpcacity:1}}),T=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(i,e);var t,n,r,a=M(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=a.call(this,e,t)).templateId="marker-proposal-popup",n.amendments={},n.setFetcher(S),n}return t=i,(n=[{key:"addControls",value:function(){C(P(i.prototype),"addControls",this).call(this),this.awesomeMap.config.menu.amendments&&this.component.amendments&&!this.awesomeMap.layers.amendments&&(this.awesomeMap.layers.amendments={label:'<span class="awesome_map-component" id="awesome_map-amendments_'.concat(this.component.id,'" title="0" data-layer="amendments">').concat(window.DecidimAwesome.texts.amendments,"</span>"),group:new o.FeatureGroup.SubGroup(this.awesomeMap.cluster)},this.awesomeMap.controls.main.addOverlay(this.awesomeMap.layers.amendments.group,this.awesomeMap.layers.amendments.label),this.awesomeMap.layers.amendments.group.addTo(this.awesomeMap.map))}},{key:"loadNodes",value:function(){var e=this;this.fetcher.onNode=function(t){var n=new o.Marker([t.coordinates.latitude,t.coordinates.longitude],{icon:e.createIcon(x,e.awesomeMap.getCategory(t.category).color),title:t.title.translation});t.amendments&&t.amendments.length&&t.amendments.forEach((function(n){e.amendments[n.emendation.id]=t})),e.addMarker(n,t)},this.fetcher.fetch()}},{key:"_onFinished",value:function(){var e=this,t=Object.entries(this.amendments);this.awesomeMap.controls.updateStats("component_".concat(this.component.id),this.allNodes.length-t.length),this.awesomeMap.controls.updateStats("amendments_".concat(this.component.id),t.length),t.forEach((function(t){var n=e.allNodes.find((function(e){return e.id===t[0]})),o=t[1];if(n){try{n.marker.removeFrom(e.controls.group)}catch(r){console.error("error removeFrom marker",n,"layer",e.controls.group,r)}e.awesomeMap.config.menu.amendments&&(n.marker.addTo(e.awesomeMap.layers.amendments.group),o.category&&(n.marker.setIcon(e.createIcon(x,e.awesomeMap.getCategory(o.category).color)),e.addMarkerCategory(n.marker,o.category)))}})),this.onFinished()}}])&&O(t.prototype,n),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(u);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==E(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===E(a)?a:String(a)),o)}var r,a}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=B(e);if(t){var r=B(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===E(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var N=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(a,e);var t,n,o,r=H(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).query="query ($id: ID!, $after: String!) {\n    component(id: $id) {\n        id\n        __typename\n        ... on Meetings {\n          meetings(first: 50, after: $after) {\n            pageInfo {\n              hasNextPage\n              endCursor\n            }\n            edges {\n              node {\n                id\n                title {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                body: description {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                startTime\n                location {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                address\n                locationHints {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                coordinates {\n                  latitude\n                  longitude\n                }\n                category {\n                  id\n                }\n              }\n            }\n          }\n        }\n      }\n    }",t}return t=a,n&&I(t.prototype,n),o&&I(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(y);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function D(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==A(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===A(a)?a:String(a)),o)}var r,a}function F(e,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F(e,t)}function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=z(e);if(t){var r=z(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function z(e){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},z(e)}var q=o.DivIcon.SVGIcon.DecidimIcon.extend({_createPathDescription:function(){return"M 15.991543,4 C 7.3956015,4 2.9250351,10.5 3.000951,16.999999 3.1063486,26.460968 12.747693,30.000004 15.991543,43 19.242091,30.000004 29,26.255134 29,16.999999 29,10.5 23.951131,4 15.996007,4 m -0.153508,2.6000001 a 2.1720294,2.1076698 0 0 1 2.330514,2.1124998 2.177008,2.1125006 0 0 1 -4.354016,0 2.1720294,2.1076698 0 0 1 2.023502,-2.1124998 m -2.651707,4.8056679 h 5.610202 l 3.935584,7.569899 -1.926038,0.934266 -2.009546,-3.859265 v 14.557403 h -2.484243 v -9.126003 h -0.642162 v 9.126003 H 13.190347 V 16.050568 l -2.009545,3.859265 -1.926036,-0.934266 3.935581,-7.569899"}}),V=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(i,e);var t,n,r,a=G(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=a.call(this,e,t)).templateId="marker-meeting-popup",n.setFetcher(N),n}return t=i,(n=[{key:"loadNodes",value:function(){var e=this;this.fetcher.onNode=function(t){var n=new o.Marker([t.coordinates.latitude,t.coordinates.longitude],{icon:e.createIcon(q,e.awesomeMap.getCategory(t.category).color),title:t.title.translation});e.addMarker(n,t)},this.fetcher.fetch()}}])&&D(t.prototype,n),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(u);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function W(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,a=void 0,a=function(e,t){if("object"!==U(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==U(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===U(a)?a:String(a)),o)}var r,a}var K=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=t,this.categories=window.AwesomeMap&&window.AwesomeMap.categories||[],this.config=$.extend({length:255,center:null,zoom:8,menu:{amendments:!1,meetings:!1,categories:!0,hashtags:!1,mergeComponents:!1},show:{withdrawn:!1,accepted:!1,evaluating:!1,notAnswered:!1,rejected:!1},hideControls:!1,collapsedMenu:!1,components:[]},n),this.layers={},this.cluster=new o.MarkerClusterGroup,this.map.addLayer(this.cluster),this.controls=new s(this),this.onFinished=function(){},this.controllers={},this.loading=[],this._firstController={}}var t,n,r;return t=e,(n=[{key:"loadControllers",value:function(){var e=this;this.autoResize(),this.controls.attach(),this.config.components.forEach((function(t){var n=e._getController(t);n&&(n.loadNodes(),e.loading.push(t.type),n.onFinished=function(){e.loading.pop(),e.autoResize(),0===e.loading.length&&(e.controls.$loading.hide(),e.onFinished())})}))}},{key:"autoResize",value:function(){var e=this.cluster.getBounds();this.config.center&&this.config.zoom?this.map.setView(this.config.center,this.config.zoom):e.isValid()&&this.map.fitBounds([[e.getNorth(),e.getEast()],[e.getSouth(),e.getWest()]],{padding:[50,50]})}},{key:"getCategory",value:function(e){var t=this,n={color:getComputedStyle(document.documentElement).getPropertyValue("--primary"),children:function(){},parent:null,name:null};if(e){var o=e.id?parseInt(e.id,10):parseInt(e,10),r=this.categories.find((function(e){return e.id===o}));if(r)return r.children=function(){return t.categories.filter((function(e){return e.parent===r.id}))},r}return n}},{key:"_getController",value:function(e){var t=null;return"proposals"===e.type&&(t=new T(this,e)),"meetings"===e.type&&this.config.menu.meetings&&(t=new V(this,e)),t?(this._firstController[e.type]&&this.config.menu.mergeComponents?t.controls=this._firstController[e.type].controls:t.addControls(),this._firstController[e.type]=this._firstController[e.type]||t,this.controllers[e.type]=t,this.controllers[e.type]):null}}])&&W(t.prototype,n),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();$((function(){var e={length:$("#awesome-map").data("truncate")||254,center:function(e){if(e){var t=e.split(",");if(t.length>=2){var n=parseFloat(t[0]),o=parseFloat(t[1]);if(n&&o)return[n,o]}}return null}($("#awesome-map").data("map-center")),zoom:$("#awesome-map").data("map-zoom"),menu:{amendments:$("#awesome-map").data("menu-amendments"),meetings:$("#awesome-map").data("menu-meetings"),categories:$("#awesome-map").data("menu-categories"),hashtags:$("#awesome-map").data("menu-hashtags"),mergeComponents:$("#awesome-map").data("menu-merge-components")},show:{withdrawn:$("#awesome-map").data("show-withdrawn"),accepted:$("#awesome-map").data("show-accepted"),evaluating:$("#awesome-map").data("show-evaluating"),notAnswered:$("#awesome-map").data("show-not-answered"),rejected:$("#awesome-map").data("show-rejected")},hideControls:$("#awesome-map").data("hide-controls"),collapsedMenu:$("#awesome-map").data("collapsed"),components:$("#awesome-map").data("components")};$("#awesome-map .google-map").on("ready.decidim",(function(t,n){n.off("popupopen"),n.off("popupclose"),window.AwesomeMap=new K(n,e),window.AwesomeMap.loadControllers()}))}))},91322:function(){!function(e){var t=/(\s*\S+|\s)$/,n=/^(\S*)/;e.truncate=function(t,n){return e("<div></div>").append(t).truncate(n).html()},e.fn.truncate=function(o){e.isNumeric(o)&&(o={length:o});var r=e.extend({},e.truncate.defaults,o);return this.each((function(){var o=e(this);r.noBreaks&&o.find("br").replaceWith(" ");var a=o.text(),i=a.length-r.length;if(r.stripTags&&o.text(a),r.words&&i>0){var s=a.slice(0,r.length).replace(t,"").length;i=r.keepFirstWord&&0===s?a.length-n.exec(a)[0].length-1:a.length-s-1}i<0||!i&&!r.truncated||e.each(o.contents().get().reverse(),(function(t,n){var o=e(n),a=o.text().length;return a<=i?(r.truncated=!0,i-=a,void o.remove()):3===n.nodeType?(r.finishBlock?e(n.splitText(a)).replaceWith(r.ellipsis):e(n.splitText(a-i-1)).replaceWith(r.ellipsis),!1):(o.truncate(e.extend(r,{length:a-i})),!1)}))}))},e.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,finishBlock:!1,length:1/0,ellipsis:"\u2026"}}(jQuery)}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e].call(a.exports,a,a.exports,o),a.exports}o.m=t,e=[],o.O=function(t,n,r,a){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],a=e[u][2];for(var s=!0,c=0;c<n.length;c++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(s=!1,a<i&&(i=a));if(s){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,r,a]},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={8981:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,i=n[0],s=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(c)var u=c(o)}for(t&&t(n);l<i.length;l++)a=i[l],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},n=self.webpackChunkapp=self.webpackChunkapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=o.O(void 0,[5732,3552],(function(){return o(2770)}));r=o.O(r)}();
//# sourceMappingURL=decidim_decidim_awesome_map-4c62c43ced4c8e8b8046.js.map