!function(){var e,t={45222:function(e,t,n){"use strict";n(14537);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,l=void 0,l=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(l)?l:String(l)),r)}var i,l}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listSelector=t.listSelector,this.minItems=t.minItems,this.hideOnMinItemsOrLessSelector=t.hideOnMinItemsOrLessSelector,this.run()}var t,n,o;return t=e,(n=[{key:"run",value:function(){var e=$(this.listSelector),t=e.find(this.hideOnMinItemsOrLessSelector);e.length<=this.minItems?t.hide():t.show()}}])&&r(t.prototype,n),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==l(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===l(i)?i:String(i)),o)}var r,i}var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wrapperSelector=t.wrapperSelector,this.selectSelector=t.selectSelector,this.listSelector=t.listSelector}var t,n,o;return t=e,(n=[{key:"run",value:function(){var e=$(this.listSelector),t=e.parents(this.wrapperSelector).find(this.selectSelector);t.find("option").slice(1).remove();for(var n=2;n<=e.length;n+=1)$('<option value="'.concat(n,'">').concat(n,"</option>")).appendTo(t)}}])&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===u(i)?i:String(i)),o)}var r,i}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$source=t.source,this.$select=t.select,this.sourceToParams=t.sourceToParams,this.run()}var t,n,o;return t=e,(n=[{key:"run",value:function(){this.$source.on("change",this._onSourceChange.bind(this)),this._onSourceChange()}},{key:"_onSourceChange",value:function(){var e=this.$select,t=this.sourceToParams(this.$source),n=this.$source.data("url");$.getJSON(n,t,(function(t){e.find("option:not([value=''])").remove();var n=e.data("selected");t.forEach((function(t){var o=$('<option value="'.concat(t.id,'">').concat(t.body,"</option>")).appendTo(e);t.id===n&&o.attr("selected",!0)})),n&&e.val(n)}))}}])&&s(t.prototype,n),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===f(i)?i:String(i)),o)}var r,i}var m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputSelector=t.inputSelector,this.targetSelector=t.targetSelector,this.maxLength=t.maxLength,this.omission=t.omission,this.placeholder=t.placeholder,this._bindEvent(),this._run()}var t,n,o;return t=e,(n=[{key:"_run",value:function(){var e=$(this.inputSelector),t=$(this.targetSelector),n=e.val()||this.placeholder;n.length>this.maxLength&&(n=n.substring(0,this.maxLength-this.omission.length)+this.omission),t.text(n)}},{key:"_bindEvent",value:function(){$(this.inputSelector).on("change",this._run.bind(this))}}])&&p(t.prototype,n),o&&p(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==h(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===h(i)?i:String(i)),o)}var r,i}var b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listSelector=t.listSelector,this.hideOnFirstSelector=t.hideOnFirstSelector,this.hideOnLastSelector=t.hideOnLastSelector,this.run()}var t,n,o;return t=e,(n=[{key:"run",value:function(){var e=$(this.listSelector),t=this.hideOnFirstSelector,n=this.hideOnLastSelector;if(1===e.length){var o=e.first();o.find(t).hide(),o.find(n).hide()}else e.each((function(o,r){r.id===e.first().attr("id")?($(r).find(t).hide(),$(r).find(n).show()):r.id===e.last().attr("id")?($(r).find(n).hide(),$(r).find(t).show()):($(r).find(n).show(),$(r).find(t).show())}))}}])&&v(t.prototype,n),o&&v(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function S(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==y(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===y(i)?i:String(i)),o)}var r,i}var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listSelector=t.listSelector,this.labelSelector=t.labelSelector,this.onPositionComputed=t.onPositionComputed,this.run()}var t,n,o;return t=e,(n=[{key:"run",value:function(){var e=this;$(this.listSelector).each((function(t,n){var o=$(n).find(e.labelSelector),r=o.html();r.match(/#(\d+)/)?o.html(r.replace(/#(\d+)/,"#".concat(t+1))):o.html("".concat(r," #").concat(t+1)),e.onPositionComputed&&e.onPositionComputed(n,t)}))}}])&&S(t.prototype,n),o&&S(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),w=n(64112);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==F(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==F(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===F(i)?i:String(i)),o)}var r,i}function q(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var O=q((function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$(t).length>0&&(0,w.Z)(t,n)[0].addEventListener("sortupdate",(function(e){var t=$(e.target).children();n.onSortUpdate&&n.onSortUpdate(t)}))}));function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==k(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===k(i)?i:String(i)),o)}var r,i}var P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wrapperSelector=t.wrapperSelector,this.containerSelector=t.containerSelector,this.fieldSelector=t.fieldSelector,this.addFieldButtonSelector=t.addFieldButtonSelector,this.addSeparatorButtonSelector=t.addSeparatorButtonSelector,this.addTitleAndDescriptionButtonSelector=t.addTitleAndDescriptionButtonSelector,this.fieldTemplateSelector=t.fieldTemplateSelector,this.separatorTemplateSelector=t.separatorTemplateSelector,this.TitleAndDescriptionTemplateSelector=t.TitleAndDescriptionTemplateSelector,this.removeFieldButtonSelector=t.removeFieldButtonSelector,this.moveUpFieldButtonSelector=t.moveUpFieldButtonSelector,this.moveDownFieldButtonSelector=t.moveDownFieldButtonSelector,this.onAddField=t.onAddField,this.onRemoveField=t.onRemoveField,this.onMoveUpField=t.onMoveUpField,this.onMoveDownField=t.onMoveDownField,this.placeholderId=t.placeholderId,this.elementCounter=0,this._enableInterpolation(),this._activateFields(),this._bindEvents()}var t,n,o;return t=e,n=[{key:"_enableInterpolation",value:function(){$.fn.replaceAttribute=function(e,t,n){return $(this).find("[".concat(e,"*=").concat(t,"]")).addBack("[".concat(e,"*=").concat(t,"]")).each((function(o,r){$(r).attr(e,$(r).attr(e).replace(t,n))})),this},$.fn.template=function(e,t){var n=$(this).find("template, .decidim-template");n.length>0&&n.html((function(n,o){return $(o).template(e,t)[0].outerHTML}));var o=$(this).find("[data-template]");return o.length>0&&o.each((function(n,o){var r=$(o),i=$(r.data("template")),l=$(i[0].outerHTML),a="".concat(i.attr("id"),"-").concat(t),c="#".concat(a);l.attr("id",a),r.attr("data-template",c).data("template",c),i.after(l),l.html((function(n,o){return $(o).template(e,t)[0].outerHTML}))})),$(this).replaceAttribute("id",e,t),$(this).replaceAttribute("name",e,t),$(this).replaceAttribute("data-tabs-content",e,t),$(this).replaceAttribute("for",e,t),$(this).replaceAttribute("tabs_id",e,t),$(this).replaceAttribute("href",e,t),$(this).replaceAttribute("value",e,t),this}}},{key:"_bindEvents",value:function(){var e=this;$(this.wrapperSelector).on("click",this.addFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.fieldTemplateSelector)}))})),this.addSeparatorButtonSelector&&$(this.wrapperSelector).on("click",this.addSeparatorButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.separatorTemplateSelector)}))})),this.addTitleAndDescriptionButtonSelector&&$(this.wrapperSelector).on("click",this.addTitleAndDescriptionButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.TitleAndDescriptionTemplateSelector)}))})),$(this.wrapperSelector).on("click",this.removeFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._removeField(t)}))})),this.moveUpFieldButtonSelector&&$(this.wrapperSelector).on("click",this.moveUpFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._moveUpField(t)}))})),this.moveDownFieldButtonSelector&&$(this.wrapperSelector).on("click",this.moveDownFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._moveDownField(t)}))}))}},{key:"_bindSafeEvent",value:function(e,t){e.preventDefault(),e.stopPropagation();try{return t(e.target)}catch(n){return console.error(n),n}}},{key:"_addField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".decidim-template",t=$(this.wrapperSelector),n=t.find(this.containerSelector),o=t.data("template"),r=null;o&&(r=$(o)),(null===r||r.length<1)&&(r=t.children("template, ".concat(e)));var i=$(r.html()).template(this.placeholderId,this._getUID());i.find("ul.tabs").attr("data-tabs",!0);var l=n.find(this.fieldSelector).last();l.length>0?l.after(i):i.appendTo(n),i.foundation(),this.onAddField&&this.onAddField(i)}},{key:"_removeField",value:function(e){var t=$(e).parents(this.fieldSelector);if(t.find("input").filter((function(e,t){return t.name.match(/id/)})).length>0){var n=t.find("input").filter((function(e,t){return t.name.match(/delete/)}));n.length>0&&$(n[0]).val(!0),t.addClass("hidden"),t.hide()}else t.remove();this.onRemoveField&&this.onRemoveField(t)}},{key:"_moveUpField",value:function(e){var t=$(e).parents(this.fieldSelector);t.prev().before(t),this.onMoveUpField&&this.onMoveUpField(t)}},{key:"_moveDownField",value:function(e){var t=$(e).parents(this.fieldSelector);t.next().after(t),this.onMoveDownField&&this.onMoveDownField(t)}},{key:"_activateFields",value:function(){var e=this,t=$(this.wrapperSelector).find(this.containerSelector);t.append(t.find("script")),$(this.fieldSelector).each((function(t,n){$(n).template(e.placeholderId,e._getUID()),$(n).find("ul.tabs").attr("data-tabs",!0)}))}},{key:"_getUID",value:function(){return this.elementCounter+=1,(new Date).getTime()+this.elementCounter}}],n&&T(t.prototype,n),o&&T(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function E(e){return new P(e)}function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==j(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===j(i)?i:String(i)),o)}var r,i}var C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controllerField=t.controllerField,this.wrapperSelector=t.wrapperSelector,this.dependentFieldsSelector=t.dependentFieldsSelector,this.dependentInputSelector=t.dependentInputSelector,this.enablingCondition=t.enablingCondition,this._bindEvent(),this._run()}var t,n,o;return t=e,(n=[{key:"_run",value:function(){var e=this.controllerField,t=e.parents(this.wrapperSelector).find(this.dependentFieldsSelector),n=t.find(this.dependentInputSelector);this.enablingCondition(e)?(n.prop("disabled",!1),t.show()):(n.prop("disabled",!0),t.hide())}},{key:"_bindEvent",value:function(){var e=this;this.controllerField.on("change",(function(){e._run()}))}}])&&x(t.prototype,n),o&&x(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e){return new C(e)}var I=n(30457),B=n(20642),D=n(43052),L=n(8671);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function R(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,t){if("object"!==M(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==M(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===M(i)?i:String(i)),o)}var r,i}function z(e,t,n){return t&&Q(e.prototype,t),n&&Q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function H(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function K(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=J(e);if(t){var r=J(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===M(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}Quill.debug("error");var X=Quill.import("delta"),G=Quill.import("blots/break"),V=Quill.import("blots/embed"),W=Quill.import("blots/scroll"),Y=Quill.import("parchment");Quill.register({"modules/history":L.Z},!0),Quill.import("ui/icons").linebreak="\u23ce";var ee=function(e){H(n,e);var t=K(n);function n(){return N(this,n),t.apply(this,arguments)}return z(n,[{key:"length",value:function(){return 1}},{key:"value",value:function(){return"\n"}},{key:"insertInto",value:function(e,t){Reflect.apply(V.prototype.insertInto,this,[e,t])}}]),n}(G);Quill.register(ee);var te=function(e){H(n,e);var t=K(n);function n(){return N(this,n),t.apply(this,arguments)}return z(n,[{key:"optimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!0!==this.batch&&(this.parchmentOptimize(e,t),e.length>0&&this.emitter.emit("scroll-optimize",e,t))}},{key:"parchmentOptimize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Reflect.apply(Y.Container.prototype.optimize,this,[n]);for(var o=R(this.observer.takeRecords());o.length>0;)t.push(o.pop());for(var r=function t(n,o){n&&n!==e&&n.domNode.parentNode&&(n.domNode.__blot&&null===n.domNode.__blot.mutations&&(n.domNode.__blot.mutations=[]),o&&t(n.parent))},i=function e(t){t.domNode.__blot&&(t instanceof Y.Container&&t.children.forEach(e),t.optimize(n))},l=t,a=0;l.length>0;a+=1){if(a>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach((function(e){var t=Y.find(e.target,!0);t&&(t.domNode===e.target&&("childList"===e.type?(r(Y.find(e.previousSibling,!1)),e.addedNodes.forEach((function(e){var t=Y.find(e,!1);r(t,!1),t instanceof Y.Container&&t.children.forEach((function(e){r(e,!1)}))}))):"attributes"===e.type&&r(t.prev)),r(t))})),this.children.forEach(i),o=(l=R(this.observer.takeRecords())).slice();o.length>0;)t.push(o.pop())}}}]),n}(W);function ne(e){var t=e.selection.getRange()[0],n=e.getLeaf(t.index)[0],o=e.getLeaf(t.index+1)[0],r=e.getText(t.index-1,1);if(null===o||n.parent!==o.parent)e.insertEmbed(t.index,"break",!0,"user"),e.insertEmbed(t.index,"break",!0,"user");else if("\n"===r){var i=(new X).retain(t.index).insert("\n");e.updateContents(i,Quill.sources.USER)}else e.insertEmbed(t.index,"break",!0,"user");e.setSelection(t.index+1,Quill.sources.SILENT)}Quill.register("blots/scroll",te,!0),Y.register(te),Quill.register("modules/linebreak",(function(e){e.getModule("toolbar").addHandler("linebreak",(function(){ne(e)})),e.emitter.on("editor-ready",(function(){var t=e.getLength();"\n\n"===e.getText(t-2,2)&&e.deleteText(e.getLength()-2,2)})),(0,I.Z)(e),(0,B.Z)(e),(0,D.Z)(e)}));n(76096),n(23401),n(68788);function oe(e){return function(e){if(Array.isArray(e))return re(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var ie=["bold","italic","link","underline","header","list","alt","break","width","style","code","blockquote","indent"];window.Decidim.createEditableForm=function(){var e=".questionnaire-question",t=".questionnaire-question-answer-option",n=".questionnaire-question-answer-options",o=".remove-answer-option",r=".questionnaire-question-matrix-row",l=".questionnaire-question-matrix-rows",a=".remove-matrix-row",u=".questionnaire-question-max-choices",s=".questionnaire-question-display-condition",f=".questionnaire-question-display-conditions",p=".remove-display-condition",h="select[name$=\\[decidim_condition_question_id\\]]",v="select[name$=\\[condition_type\\]]",y="input[name$=\\[deleted\\]]",S=new b({listSelector:".questionnaire-question:not(.hidden)",hideOnFirstSelector:".move-up-question",hideOnLastSelector:".move-down-question"}),w=new g({listSelector:".questionnaire-question:not(.hidden)",labelSelector:".card-title span:first",onPositionComputed:function(t,n){$(t).find("input[name$=\\[position\\]]:not([name*=\\[matrix_rows\\]])").val(n),S.run(),$(e).each((function(e,t){var n=$(t);e?(n.find(f).find(y).val("false"),n.find(f).show()):(n.find(f).find(y).val("true"),n.find(f).hide())}))}}),F=["single_option","multiple_option","sorting","matrix_single","matrix_multiple"],_=["matrix_single","matrix_multiple"],q=function(){new O(".questionnaire-questions-list:not(.published)",{handle:".question-divider",placeholder:'<div style="border-style: dashed; border-color: #000"></div>',forcePlaceholderSize:!0,onSortUpdate:function(){w.run(),S.run()}})},k=function(e){var t,n="#".concat(e," .question-title-statement"),o=$(n).data("locale"),r=$(n).data("max-length"),i=$(n).data("omission"),l=$(n).data("placeholder");return t={inputSelector:"#".concat(e," input[name$=\\[body_").concat(o,"\\]]"),targetSelector:n,maxLength:r,omission:i,placeholder:l},new m(t)},T=function(r){var l=function(t){return new i({wrapperSelector:e,listSelector:"#".concat(t," ").concat(n," .questionnaire-question-answer-option:not(.hidden)"),minItems:2,hideOnMinItemsOrLessSelector:o})}(r),a=function(t){return new c({wrapperSelector:e,selectSelector:"".concat(u," select"),listSelector:"#".concat(t," ").concat(n," .questionnaire-question-answer-option:not(.hidden)")})}(r);return E({placeholderId:"questionnaire-question-answer-option-id",wrapperSelector:"#".concat(r," ").concat(n),containerSelector:".questionnaire-question-answer-options-list",fieldSelector:t,addFieldButtonSelector:".add-answer-option",fieldTemplateSelector:".decidim-answer-option-template",removeFieldButtonSelector:o,onAddField:function(){l.run(),a.run()},onRemoveField:function(){l.run(),a.run()}})},P={},j={},x=function(e){return F.indexOf(e)>=0},C=function(e){return _.indexOf(e)>=0},I=function(e){var t=e.options[e.selectedIndex];return $(t).data("type")},B=function(e){var t=e.find(h),n=I(t[0]),o=x(n),r=["answered","not_answered"];o&&(r.push("equal"),r.push("not_equal")),r.push("match");var i=e.find(v);i.find("option").each((function(e,t){var n=$(t),o=n.val();o&&(n.show(),r.indexOf(o)<0&&n.hide())})),r.indexOf(i.val())<0&&i.val(r[0]),i.trigger("change")},D=function(e){var t=e.find(v).val(),n=e.find(".questionnaire-question-display-condition-value"),o=e.find(".questionnaire-question-display-condition-answer-option"),r=e.find(h),i=I(r[0]),l=x(i);"match"===t?n.show():n.hide(),!l||"not_equal"!==t&&"equal"!==t?o.hide():o.show()},L=function(e){var t=function(e){return new d({source:e.find(h),select:e.find("select[name$=\\[decidim_answer_option_id\\]]"),sourceToParams:function(e){return{id:e.val()}}})}(e);t.run(),e.find(h).on("change",(function(){B(e)})),e.find(v).on("change",(function(){D(e)})),D(e),B(e)},M={},R=function(o){var i=o.attr("id"),c=o.find("select[name$=\\[question_type\\]]");!function(e){var t=e.find(".collapsible");if(t.length>0){var n=t.attr("id").replace("-question-card",""),o="".concat(n,"-question-card button--collapse-question-").concat(n," button--expand-question-").concat(n);e.find(".question--collapse").data("toggle",o)}}(o),k(i),A({controllerField:c,wrapperSelector:e,dependentFieldsSelector:n,dependentInputSelector:"".concat(t," input"),enablingCondition:function(e){return x(e.val())}}),A({controllerField:c,wrapperSelector:e,dependentFieldsSelector:u,dependentInputSelector:"select",enablingCondition:function(e){return"multiple_option"===e.val()||"matrix_multiple"===e.val()}}),A({controllerField:c,wrapperSelector:e,dependentFieldsSelector:l,dependentInputSelector:"".concat(r," input"),enablingCondition:function(e){return C(e.val())}}),P[i]=T(i),j[i]=function(e){return E({placeholderId:"questionnaire-question-matrix-row-id",wrapperSelector:"#".concat(e," ").concat(l),containerSelector:".questionnaire-question-matrix-rows-list",fieldSelector:r,addFieldButtonSelector:".add-matrix-row",fieldTemplateSelector:".decidim-matrix-row-template",removeFieldButtonSelector:a,onAddField:function(){},onRemoveField:function(){}})}(i),M[i]=function(e){return E({placeholderId:"questionnaire-question-display-condition-id",wrapperSelector:"#".concat(e," ").concat(f),containerSelector:".questionnaire-question-display-conditions-list",fieldSelector:s,addFieldButtonSelector:".add-display-condition",removeFieldButtonSelector:p,onAddField:function(e){L(e)},onRemoveField:function(){}})}(i);var d=P[i],m=j[i],h=function(){x(c.val())&&(0===c.parents(e).find(t).length&&(d._addField(),d._addField()));C(c.val())&&(0===c.parents(e).find(r).length&&(m._addField(),m._addField()))};c.on("change",h),h()};E({placeholderId:"questionnaire-question-id",wrapperSelector:".questionnaire-questions",containerSelector:".questionnaire-questions-list",fieldSelector:e,addFieldButtonSelector:".add-question",addSeparatorButtonSelector:".add-separator",addTitleAndDescriptionButtonSelector:".add-title-and-description",fieldTemplateSelector:".decidim-question-template",separatorTemplateSelector:".decidim-separator-template",TitleAndDescriptionTemplateSelector:".decidim-title-and-description-template",removeFieldButtonSelector:".remove-question",moveUpFieldButtonSelector:".move-up-question",moveDownFieldButtonSelector:".move-down-question",onAddField:function(e){R(e),q(),e.find(".editor-container").each((function(e,t){!function(e){var t=$(e).data("toolbar"),n=$(e).data("disabled"),o=[["bold","italic","underline","linebreak"],[{list:"ordered"},{list:"bullet"}],["link","clean"],["code","blockquote"],[{indent:"-1"},{indent:"+1"}]],r=!1,i=!1;"content"===t?o=[[{header:[2,3,4,5,6,!1]}]].concat(oe(o)):"full"===t&&(r=!0,i=!0,o=[[{header:[2,3,4,5,6,!1]}]].concat(oe(o),[["video"],["image"]]));var l={linebreak:{},toolbar:{container:o,handlers:{linebreak:ne}}},a=$(e).siblings('input[type="hidden"]');e.innerHTML=a.val()||"";var c=$('meta[name="csrf-token"]').attr("content");if(i&&ie.push("video"),r){ie.push("image"),l.imageResize={modules:["Resize","DisplaySize"]},l.imageUpload={url:$(e).data("uploadImagesPath"),method:"POST",name:"image",withCredentials:!1,headers:{"X-CSRF-Token":c},callbackOK:function(e,t){$("div.ql-toolbar").last().removeClass("editor-loading"),t(e.url)},callbackKO:function(e){$("div.ql-toolbar").last().removeClass("editor-loading"),console.log("Image upload error: ".concat(e.message))},checkBeforeSend:function(e,t){$("div.ql-toolbar").last().addClass("editor-loading"),t(e)}};var u=$(e).data("dragAndDropHelpText");$(e).after('<p class="help-text" style="margin-top:-1.5rem;">'.concat(u,"</p>"))}var s=new Quill(e,{modules:l,formats:ie,theme:"snow"});!1===r&&s.root.addEventListener("drop",(function(e){return e.preventDefault()})),n&&s.disable(),s.on("text-change",(function(){var t=s.getText(),n=new CustomEvent("quill-position",{detail:s.getSelection()});if(e.dispatchEvent(n),"\n"!==t&&"\n\n"!==t||0!==s.root.querySelectorAll("iframe").length){var o="<p><br></p>",r=s.root.innerHTML.replace(new RegExp("^".concat(o,"|").concat(o,"$"),"g"),"");a.val(r)}else a.val("")})),s.emitter.emit("editor-ready")}(t)})),w.run(),S.run(),e.find("select.language-change").toArray().forEach((function(e){e.addEventListener("change",(function(){var t=e.value,n=e.parentElement.parentElement.nextElementSibling;n.querySelector(".is-active").classList.remove("is-active"),n.querySelector(t).classList.add("is-active")}))}))},onRemoveField:function(e){w.run(),S.run(),e.find(o).each((function(t,n){P[e.attr("id")]._removeField(n)})),e.find(a).each((function(t,n){j[e.attr("id")]._removeField(n)})),e.find(p).each((function(t,n){M[e.attr("id")]._removeField(n)}))},onMoveUpField:function(){w.run(),S.run()},onMoveDownField:function(){w.run(),S.run()}}),q(),$(e).each((function(e,t){var n=$(t);!function(e){"true"===e.find("input[name$=\\[deleted\\]]").val()&&(e.addClass("hidden"),e.hide())}(n),R(n)})),$(s).each((function(e,t){var n=$(t);L(n)})),w.run(),S.run()}},14537:function(){window,$("button.collapse-all").on("click",(function(){$(".collapsible").addClass("hide"),$(".question--collapse .icon-expand").removeClass("hide"),$(".question--collapse .icon-collapse").addClass("hide")})),$("button.expand-all").on("click",(function(){$(".collapsible").removeClass("hide"),$(".question--collapse .icon-expand").addClass("hide"),$(".question--collapse .icon-collapse").removeClass("hide")}))}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=t,e=[],o.O=function(t,n,r,i){if(!n){var l=1/0;for(s=0;s<e.length;s++){n=e[s][0],r=e[s][1],i=e[s][2];for(var a=!0,c=0;c<n.length;c++)(!1&i||l>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(a=!1,i<l&&(l=i));if(a){e.splice(s--,1);var u=r();void 0!==u&&(t=u)}}return t}i=i||0;for(var s=e.length;s>0&&e[s-1][2]>i;s--)e[s]=e[s-1];e[s]=[n,r,i]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={9985:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,l=n[0],a=n[1],c=n[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(c)var s=c(o)}for(t&&t(n);u<l.length;u++)i=l[u],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(s)},n=self.webpackChunkapp=self.webpackChunkapp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=o.O(void 0,[2415,4112,7277],(function(){return o(45222)}));r=o.O(r)}();
//# sourceMappingURL=decidim_forms_admin-8b0b3ed068665b31cdbb.js.map