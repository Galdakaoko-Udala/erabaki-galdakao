{"version":3,"file":"js/1936-dc0baac2204eee890ee8.js","mappings":"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","sources":["webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/configuration.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/confirm.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/direct_uploads/uploader.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/direct_uploads/upload_utility.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/utilities/text.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/direct_uploads/upload_modal.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/direct_uploads/upload_field.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/editor.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/editor/linebreak_module.js","webpack://app/../.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-core-0.27.5/app/packs/src/decidim/input_tags.js"],"sourcesContent":["export default class Configuration {\n  constructor() {\n    this.config = {};\n  }\n\n  set(key, value = null) {\n    if (typeof key === \"object\") {\n      this.config = { ...this.config, ...key };\n    } else {\n      this.config[key] = value;\n    }\n  }\n\n  get(key) {\n    return this.config[key];\n  }\n}\n","/**\n * A custom confirm dialog for Decidim based on Foundation reveals.\n *\n * Note that this needs to be loaded before the application JS in order for\n * it to gain control over the confirm events BEFORE rails-ujs is loaded.\n */\n\nimport Rails from \"@rails/ujs\"\n\nlet TEMPLATE_HTML = null;\n\nclass ConfirmDialog {\n  constructor(sourceElement) {\n    this.$modal = $(TEMPLATE_HTML);\n    this.$source = sourceElement;\n    this.$content = $(\".confirm-modal-content\", this.$modal);\n    this.$buttonConfirm = $(\"[data-confirm-ok]\", this.$modal);\n    this.$buttonCancel = $(\"[data-confirm-cancel]\", this.$modal);\n\n    // Avoid duplicate IDs and append the new modal to the body\n    const titleId = `confirm-modal-title-${Math.random().toString(36).substring(7)}`;\n\n    this.$modal.removeAttr(\"id\");\n    $(\"#confirm-modal-title\", this.$modal).attr(\"id\", titleId);\n    this.$modal.attr(\"aria-labelledby\", titleId);\n\n    $(\"body\").append(this.$modal);\n    this.$modal.foundation();\n  }\n\n  confirm(message) {\n    this.$content.html(message);\n\n    this.$buttonConfirm.off(\"click\");\n    this.$buttonCancel.off(\"click\");\n\n    return new Promise((resolve) => {\n      this.$buttonConfirm.on(\"click\", (ev) => {\n        ev.preventDefault();\n\n        this.$modal.foundation(\"close\");\n        resolve(true);\n        this.$source.focus();\n      });\n      this.$buttonCancel.on(\"click\", (ev) => {\n        ev.preventDefault();\n\n        this.$modal.foundation(\"close\");\n        resolve(false);\n        this.$source.focus();\n      });\n\n      this.$modal.foundation(\"open\").on(\"closed.zf.reveal\", () => {\n        this.$modal.remove();\n      });\n    });\n  }\n}\n\n// Override the default confirm dialog by Rails\n// See:\n// https://github.com/rails/rails/blob/fba1064153d8e2f4654df7762a7d3664b93e9fc8/actionview/app/assets/javascripts/rails-ujs/features/confirm.coffee\n//\n// There is apparently a better way coming in Rails 6:\n// https://github.com/rails/rails/commit/e9aa7ecdee0aa7bb4dcfa5046881bde2f1fe21cc#diff-e1aaa45200e9adcbcb8baf1c5375b5d1\n//\n// The old approach is broken according to https://github.com/rails/rails/issues/36686#issuecomment-514213323\n// so for the moment this needs to be executed **before** Rails.start()\nconst allowAction = (ev, element) => {\n  const message = $(element).data(\"confirm\");\n  if (!message) {\n    return true;\n  }\n\n  if (!Rails.fire(element, \"confirm\")) {\n    return false;\n  }\n\n  if (TEMPLATE_HTML === null) {\n    TEMPLATE_HTML = $(\"#confirm-modal\")[0].outerHTML;\n    $(\"#confirm-modal\").remove();\n  }\n\n  const dialog = new ConfirmDialog(\n    $(element)\n  );\n  dialog.confirm(message).then((answer) => {\n    const completed = Rails.fire(element, \"confirm:complete\", [answer]);\n    if (answer && completed) {\n      // Allow the event to propagate normally and re-dispatch it without\n      // the confirm data attribute which the Rails internal method is\n      // checking.\n      $(element).data(\"confirm\", null);\n      $(element).removeAttr(\"data-confirm\");\n\n      // The submit button click events won't do anything if they are\n      // dispatched as is. In these cases, just submit the underlying form.\n      if (ev.type === \"click\" &&\n        (\n          $(element).is('button[type=\"submit\"]') ||\n          $(element).is('input[type=\"submit\"]')\n        )\n      ) {\n        $(element).parents(\"form\").submit();\n      } else {\n        let origEv = ev.originalEvent || ev;\n        let newEv = origEv;\n        if (typeof Event === \"function\") {\n          // Clone the event because otherwise some click events may not\n          // work properly when re-dispatched.\n          newEv = new origEv.constructor(origEv.type, origEv);\n        }\n        ev.target.dispatchEvent(newEv);\n      }\n    }\n  });\n\n  return false;\n};\nconst handleConfirm = (ev, element) => {\n  if (!allowAction(ev, element)) {\n    Rails.stopEverything(ev);\n  }\n};\nconst getMatchingEventTarget = (ev, selector) => {\n  let target = ev.target;\n  while (!(!(target instanceof Element) || Rails.matches(target, selector))) {\n    target = target.parentNode;\n  }\n\n  if (target instanceof Element) {\n    return target;\n  }\n\n  return null;\n};\nconst handleDocumentEvent = (ev, matchSelectors) => {\n  return matchSelectors.some((currentSelector) => {\n    let target = getMatchingEventTarget(ev, currentSelector);\n    if (target === null) {\n      return false;\n    }\n\n    handleConfirm(ev, target);\n    return true;\n  });\n};\n\ndocument.addEventListener(\"click\", (ev) => {\n  return handleDocumentEvent(ev, [\n    Rails.linkClickSelector,\n    Rails.buttonClickSelector,\n    Rails.formInputClickSelector\n  ]);\n});\ndocument.addEventListener(\"change\", (ev) => {\n  return handleDocumentEvent(ev, [Rails.inputChangeSelector]);\n});\ndocument.addEventListener(\"submit\", (ev) => {\n  return handleDocumentEvent(ev, [Rails.formSubmitSelector]);\n});\n\n// This is needed for the confirm dialog to work with Foundation Abide.\n// Abide registers its own submit click listeners since Foundation 5.6.x\n// which will be handled before the document listeners above. This would\n// break the custom confirm functionality when used with Foundation Abide.\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  $(Rails.formInputClickSelector).on(\"click.confirm\", (ev) => {\n    handleConfirm(ev, getMatchingEventTarget(ev, Rails.formInputClickSelector));\n  });\n});\n","import { DirectUpload } from \"@rails/activestorage\";\n\nexport class Uploader {\n  constructor(modal, uploadItem, options) {\n    this.modal = modal;\n    this.uploadItem = uploadItem;\n    this.progressBar = uploadItem.querySelector(\".progress-bar\");\n    this.validationSent = false;\n    this.fileTooBig = false;\n    if (modal.options.maxFileSize && options.file.size > modal.options.maxFileSize) {\n      this.fileTooBig = true;\n      this.showError([modal.locales.file_size_too_large]);\n    } else {\n      this.upload = new DirectUpload(options.file, options.url, this);\n    }\n  }\n\n  showError(errors) {\n    this.progressBar.classList.add(\"filled\");\n    this.progressBar.innerHTML = this.modal.locales.validation_error;\n    this.uploadItem.dataset.state = \"error\";\n    const errorList = this.uploadItem.querySelector(\".upload-errors\");\n    errors.forEach((error) => {\n      const errorItem = document.createElement(\"li\");\n      errorItem.classList.add(\"form-error\", \"is-visible\");\n      errorItem.innerHTML = error;\n      errorList.appendChild(errorItem);\n    })\n  }\n\n  validate(blobId) {\n    const callback = (data) => {\n      let errors = []\n      for (const [, value] of Object.entries(data)) {\n        errors = errors.concat(value);\n      }\n\n      this.progressBar.style.justifyContent = \"center\";\n      if (errors.length === 0) {\n        this.progressBar.innerHTML = this.modal.locales.uploaded;\n        this.uploadItem.dataset.state = \"validated\";\n      } else {\n        this.showError(errors);\n      }\n      this.progressBar.classList.add(\"filled\");\n    }\n\n    if (!this.validationSent) {\n      let property = this.modal.options.addAttribute;\n      if (this.modal.options.titled) {\n        property = \"file\"\n      }\n\n      let url = this.modal.input.dataset.uploadValidationsUrl;\n\n      const params = new URLSearchParams({\n        resourceClass: this.modal.options.resourceClass,\n        property: property,\n        blob: blobId,\n        formClass: this.modal.options.formObjectClass\n      });\n\n      fetch(`${url}?${params}`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-CSRF-Token\": $(\"meta[name=csrf-token]\").attr(\"content\")\n        }\n      }).then((response) => response.json()).then((data) => {\n        callback(data);\n      });\n      this.validationSent = true;\n    }\n  }\n\n  directUploadWillStoreFileWithXHR(request) {\n    request.upload.addEventListener(\"progress\", (event) => {\n      const progress = Math.floor(event.loaded / event.total * 100);\n      let width = \"15%\";\n      if (progress > 15) {\n        width = `${progress}%`;\n      }\n      this.progressBar.style.width = width;\n\n      if (progress === 100) {\n        this.progressBar.innerHTML = this.modal.locales.validating;\n        return;\n      }\n      this.progressBar.innerHTML = `${progress}%`;\n    });\n  }\n}\n","export const checkTitles = (parentElement, saveButton) => {\n  let everyItemHasTitle = true;\n\n  Array.from(parentElement.children).forEach((item) => {\n    const title = item.querySelector(\"input[type='text']\").value;\n    const noTitleErrorSpan = item.querySelector(\".no-title-error\");\n    if (!title || title.length === 0) {\n      everyItemHasTitle = false;\n      saveButton.disabled = true;\n      noTitleErrorSpan.classList.add(\"is-visible\");\n      item.appendChild(noTitleErrorSpan);\n    } else {\n      noTitleErrorSpan.classList.remove(\"is-visible\");\n    }\n  });\n\n  if (everyItemHasTitle) {\n    saveButton.disabled = false;\n  }\n}\n\nexport const truncateFilename = (filename, maxLength = 31) => {\n  if (filename.length <= maxLength) {\n    return filename;\n  }\n\n  const charactersFromBegin = Math.floor(maxLength / 2) - 3;\n  const charactersFromEnd = maxLength - charactersFromBegin - 3;\n  return `${filename.slice(0, charactersFromBegin)}...${filename.slice(-charactersFromEnd)}`;\n}\n\nexport const createHiddenInput = (elClasses, elName, elValue) => {\n  const el = document.createElement(\"input\");\n  el.type = \"hidden\";\n  if (elClasses) {\n    if (typeof (elClasses) === \"string\") {\n      el.className = elClasses;\n    } else {\n      el.className = elClasses.join(\" \")\n    }\n  }\n  if (elName) {\n    el.name = elName;\n  }\n  if (elValue) {\n    el.value = elValue;\n  }\n  return el;\n}\n","export const escapeHtml = (text) => {\n  if (!text) {\n    return \"\";\n  }\n\n  const el = document.createElement(\"div\");\n  el.appendChild(document.createTextNode(text));\n  return el.innerHTML;\n}\n\nexport const escapeQuotes = (text) => {\n  if (!text) {\n    return \"\";\n  }\n\n  return text.replace(/\"/g, \"&quot;\");\n}\n","import { Uploader } from \"src/decidim/direct_uploads/uploader\";\nimport { truncateFilename, checkTitles, createHiddenInput } from \"src/decidim/direct_uploads/upload_utility\";\nimport { escapeHtml } from \"src/decidim/utilities/text\";\n\n// This class handles logic inside upload modal, but since modal is not inside the form\n// logic here moves \"upload items\" / hidden inputs to form.\nexport default class UploadModal {\n  constructor(button, options = {}) {\n    // Button that opens the modal.\n    this.button = button;\n\n    // The provided options contains the options passed from the view in the\n    // `data-upload` attribute as a JSON.\n    let providedOptions = {};\n    try {\n      // The providedOptions can contain the following keys:\n      // - addAttribute - Field name / attribute of resource (e.g. avatar)\n      // - resourceName - The resource to which the attribute belongs (e.g. user)\n      // - resourceClass - Ruby class of the resource (e.g. Decidim::User)\n      // - multiple - Defines if multiple files can be uploaded\n      // - titled - Defines if file(s) can have titles\n      // - maxFileSize - Defines maximum file size in bytes\n      // - formObjectClass - Class of the current form object (e.g. Decidim::AccountForm)\n      providedOptions = JSON.parse(button.dataset.upload);\n    } catch (_e) {\n      // Don't care about the parse errors, just skip the provided options.\n    }\n\n    this.options = Object.assign(providedOptions, options)\n\n    this.name = this.button.name;\n    this.modal = document.querySelector(`#${button.dataset.open}`);\n    this.saveButton = this.modal.querySelector(`button.add-file-${this.name}`);\n    this.attachmentCounter = 0;\n    this.dropZoneEnabled = true;\n    this.modalTitle = this.modal.querySelector(\".reveal__title\");\n    this.uploadItems = this.modal.querySelector(\".upload-items\");\n    this.locales = JSON.parse(this.uploadItems.dataset.locales);\n    this.dropZone = this.modal.querySelector(\".dropzone\");\n    this.input = this.dropZone.querySelector(\"input\");\n    this.uploadContainer = document.querySelector(`.upload-container-for-${this.name}`);\n    this.activeAttachments = this.uploadContainer.querySelector(\".active-uploads\");\n    this.trashCan = this.createTrashCan();\n  }\n\n  uploadFile(file) {\n    if (!this.dropZoneEnabled) {\n      return;\n    }\n\n    const title = file.name.split(\".\")[0].slice(0, 31);\n    const uploadItem = this.createUploadItem(file.name, title, \"init\");\n    const uploader = new Uploader(this, uploadItem, {\n      file: file,\n      url: this.input.dataset.directUploadUrl,\n      attachmentName: file.name\n    });\n    if (uploader.fileTooBig) {\n      return;\n    }\n\n    uploader.upload.create((error, blob) => {\n      if (error) {\n        uploadItem.dataset.state = \"error\";\n        const progressBar = uploadItem.querySelector(\".progress-bar\");\n        progressBar.classList.add(\"filled\");\n        progressBar.innerHTML = this.locales.error;\n        console.error(error);\n      } else {\n        const ordinalNumber = this.getOrdinalNumber();\n\n        const attachmentDetails = document.createElement(\"div\");\n        attachmentDetails.classList.add(\"attachment-details\");\n        attachmentDetails.dataset.fileid = uploadItem.dataset.fileid;\n        attachmentDetails.dataset.filename = file.name;\n        const titleAndFileNameSpan = document.createElement(\"span\");\n        titleAndFileNameSpan.style.display = \"none\";\n        attachmentDetails.appendChild(titleAndFileNameSpan);\n\n        const hiddenBlobField = createHiddenInput(null, null, blob.signed_id);\n        if (this.options.titled) {\n          hiddenBlobField.name = `${this.options.resourceName}[${this.options.addAttribute}][${ordinalNumber}][file]`;\n        } else {\n          hiddenBlobField.name = `${this.options.resourceName}[${this.options.addAttribute}]`;\n        }\n\n        if (this.options.titled) {\n          const hiddenTitleField = createHiddenInput(\"hidden-title\", `${this.options.resourceName}[${this.options.addAttribute}][${ordinalNumber}][title]`, title);\n          titleAndFileNameSpan.innerHTML = escapeHtml(`${title} (${file.name})`);\n          attachmentDetails.appendChild(hiddenTitleField);\n        } else {\n          titleAndFileNameSpan.innerHTML = escapeHtml(file.name);\n        }\n\n        if (!this.options.multiple) {\n          this.cleanTrashCan();\n        }\n\n        attachmentDetails.appendChild(hiddenBlobField);\n        uploadItem.appendChild(attachmentDetails);\n        uploader.validate(blob.signed_id);\n      }\n    });\n    this.updateDropZone();\n  }\n\n  getOrdinalNumber() {\n    const nextOrdinalNumber = this.attachmentCounter;\n    this.attachmentCounter += 1;\n    return nextOrdinalNumber;\n  }\n\n  updateDropZone() {\n    if (this.options.multiple) {\n      return;\n    }\n\n    if (this.uploadItems.children.length > 0) {\n      this.dropZone.classList.add(\"disabled\");\n      this.dropZoneEnabled = false;\n      this.input.disabled = true;\n    } else {\n      this.dropZone.classList.remove(\"disabled\");\n      this.dropZoneEnabled = true;\n      this.input.disabled = false;\n    }\n  }\n\n  createUploadItem(fileName, title, state) {\n    const wrapper = document.createElement(\"div\");\n    wrapper.classList.add(\"upload-item\");\n    wrapper.setAttribute(\"data-fileid\", Math.random().toString(36).substring(7));\n    wrapper.setAttribute(\"data-filename\", fileName);\n\n    const firstRow = document.createElement(\"div\");\n    const secondRow = document.createElement(\"div\");\n    const thirdRow = document.createElement(\"div\");\n    firstRow.classList.add(\"row\", \"upload-item-first-row\");\n    secondRow.classList.add(\"row\", \"upload-item-second-row\");\n    thirdRow.classList.add(\"row\", \"upload-item-third-row\");\n\n    const fileNameSpan = document.createElement(\"span\");\n    let fileNameSpanClasses = [\"columns\", \"file-name-span\"];\n    if (this.options.titled) {\n      fileNameSpanClasses.push(\"small-4\", \"medium-5\");\n    } else {\n      fileNameSpanClasses.push(\"small-12\");\n    }\n    fileNameSpan.classList.add(...fileNameSpanClasses);\n    fileNameSpan.innerHTML = escapeHtml(truncateFilename(fileName));\n\n    const progressBar = document.createElement(\"div\");\n    progressBar.classList.add(\"progress-bar\");\n    if (state) {\n      if (state === \"validated\") {\n        progressBar.innerHTML = this.locales.uploaded;\n      } else {\n        progressBar.innerHTML = \"0%\";\n        progressBar.style.width = \"15%\";\n      }\n      wrapper.dataset.state = state;\n    }\n\n    const progressBarBorder = document.createElement(\"div\");\n    progressBarBorder.classList.add(\"progress-bar-border\");\n    progressBarBorder.appendChild(progressBar);\n\n    const progressBarWrapper = document.createElement(\"div\");\n    progressBarWrapper.classList.add(\"columns\", \"progress-bar-wrapper\");\n    progressBarWrapper.appendChild(progressBarBorder);\n    if (this.options.titled) {\n      progressBarWrapper.classList.add(\"small-4\", \"medium-5\");\n    } else {\n      progressBarWrapper.classList.add(\"small-10\");\n    }\n\n    const errorList = document.createElement(\"ul\");\n    errorList.classList.add(\"upload-errors\");\n\n    const removeButton = document.createElement(\"button\");\n    removeButton.classList.add(\"columns\", \"small-3\", \"medium-2\", \"remove-upload-item\");\n    removeButton.innerHTML = `&times; ${this.locales.remove}`;\n    removeButton.addEventListener((\"click\"), (event) => {\n      event.preventDefault();\n      this.trashCan.append(wrapper);\n      this.updateDropZone();\n    })\n\n    const titleAndFileNameSpan = document.createElement(\"span\");\n    titleAndFileNameSpan.classList.add(\"columns\", \"small-5\", \"title-and-filename-span\");\n    titleAndFileNameSpan.innerHTML = escapeHtml(`${title} (${truncateFilename(fileName)})`);\n\n    firstRow.appendChild(fileNameSpan);\n    secondRow.appendChild(progressBarWrapper);\n    thirdRow.appendChild(errorList);\n\n    let titleInputContainer = null;\n    if (this.options.titled) {\n      const titleInput = document.createElement(\"input\");\n      titleInput.classList.add(\"attachment-title\");\n      titleInput.type = \"text\";\n      titleInput.value = title;\n      titleInput.addEventListener(\"input\", (event) => {\n        event.preventDefault();\n        checkTitles(this.uploadItems, this.saveButton);\n      })\n      titleInputContainer = document.createElement(\"div\");\n      titleInputContainer.classList.add(\"columns\", \"small-5\", \"title-input-container\");\n      titleInputContainer.appendChild(titleInput);\n\n      const noTitleErrorSpan = document.createElement(\"span\");\n      noTitleErrorSpan.classList.add(\"form-error\", \"no-title-error\");\n      noTitleErrorSpan.role = \"alert\";\n      noTitleErrorSpan.innerHTML = this.locales.title_required;\n      titleInputContainer.appendChild(noTitleErrorSpan);\n\n      const titleLabelSpan = document.createElement(\"span\");\n      titleLabelSpan.classList.add(\"title-label-span\");\n      titleLabelSpan.innerHTML = this.locales.title;\n\n      const titleContainer = document.createElement(\"div\");\n      titleContainer.classList.add(\"columns\", \"small-8\", \"medium-7\", \"title-container\");\n      titleContainer.appendChild(titleLabelSpan);\n      firstRow.appendChild(titleContainer);\n      secondRow.appendChild(titleInputContainer);\n    }\n\n    secondRow.appendChild(removeButton);\n\n    wrapper.appendChild(firstRow);\n    wrapper.appendChild(secondRow);\n    wrapper.appendChild(thirdRow);\n\n    this.uploadItems.appendChild(wrapper);\n\n    return wrapper;\n  }\n\n  updateAddAttachmentsButton() {\n    if (this.activeAttachments.children.length === 0) {\n      this.button.innerHTML = this.modalTitle.dataset.addlabel;\n    } else {\n      this.button.innerHTML = this.modalTitle.dataset.editlabel;\n    }\n  }\n\n  createTrashCan() {\n    const trashCan =  document.createElement(\"div\");\n    trashCan.classList.add(\"trash-can\");\n    trashCan.style.display = \"none\";\n    this.uploadItems.parentElement.appendChild(trashCan);\n    return trashCan;\n  }\n\n  cleanTrashCan() {\n    Array.from(this.trashCan.children).forEach((item) => {\n      const fileId = item.dataset.fileid;\n      const activeAttachment = this.activeAttachments.querySelector(`div[data-fileid='${fileId}']`);\n      if (activeAttachment) {\n        activeAttachment.remove();\n      }\n      item.remove();\n    })\n  }\n}\n","import UploadModal from \"src/decidim/direct_uploads/upload_modal\";\nimport { truncateFilename, createHiddenInput } from \"src/decidim/direct_uploads/upload_utility\";\nimport { escapeHtml } from \"src/decidim/utilities/text\";\n\nconst loadAttachments = (modal) => {\n  Array.from(modal.activeAttachments.children).forEach((child) => {\n    const uploadItem = modal.createUploadItem(child.dataset.filename, child.dataset.title, \"validated\");\n    child.dataset.fileid = uploadItem.dataset.fileid;\n  })\n}\n\nconst addInputEventListener = (modal) => {\n  modal.input.addEventListener(\"change\", (event) => {\n    event.preventDefault();\n    const files = event.target.files;\n    Array.from(files).forEach((file) => modal.uploadFile(file));\n  })\n}\n\nconst addButtonEventListener = (modal) => {\n  modal.button.addEventListener(\"click\", (event) => {\n    event.preventDefault();\n    Array.from(modal.trashCan.children).forEach((item) => {\n      modal.uploadItems.append(item);\n    })\n    if (modal.uploadItems.children.length === 0) {\n      modal.modalTitle.innerHTML = modal.modalTitle.dataset.addlabel;\n    } else {\n      modal.modalTitle.innerHTML = modal.modalTitle.dataset.editlabel;\n    }\n    modal.updateDropZone();\n  })\n}\n\nconst addDropZoneEventListeners = (modal) => {\n  modal.dropZone.addEventListener(\"dragenter\", (event) => {\n    event.preventDefault();\n  })\n\n  modal.dropZone.addEventListener(\"dragover\", (event) => {\n    event.preventDefault();\n    modal.dropZone.classList.add(\"is-dragover\");\n  })\n\n  modal.dropZone.addEventListener(\"dragleave\", () => {\n    modal.dropZone.classList.remove(\"is-dragover\");\n  })\n\n  modal.dropZone.addEventListener(\"drop\", (event) => {\n    event.preventDefault();\n    const files = event.dataTransfer.files;\n    Array.from(files).forEach((file) => modal.uploadFile(file));\n  })\n}\n\nconst addSaveButtonEventListener = (modal) => {\n  modal.saveButton.addEventListener(\"click\", (event) => {\n    event.preventDefault();\n    const validatedItems = modal.uploadItems.querySelectorAll(\".upload-item[data-state='validated']\")\n    const validatedItemsCount = validatedItems.length;\n    validatedItems.forEach((item) => {\n      let details = item.querySelector(\".attachment-details\");\n      if (details) {\n        modal.activeAttachments.appendChild(details);\n      } else {\n        details = modal.activeAttachments.querySelector(`.attachment-details[data-fileid='${item.dataset.fileid}'`);\n      }\n      const span = details.querySelector(\"span\");\n      span.classList.add(\"filename\");\n      if (modal.options.titled) {\n        const title = item.querySelector(\"input[type='text']\").value;\n        details.dataset.title = title;\n        let hiddenTitle = details.querySelector(\".hidden-title\")\n        if (hiddenTitle) {\n          hiddenTitle.value = title;\n        } else {\n          const attachmentId = details.querySelector(`[name='${modal.options.resourceName}[${modal.name}][]'`).value\n          const ordinalNumber = modal.getOrdinalNumber()\n          const hiddenTitleField = createHiddenInput(\"hidden-title\", `${modal.options.resourceName}[${modal.options.addAttribute}][${ordinalNumber}][title]`, title)\n          const hiddenIdField = createHiddenInput(\"hidden-id\", `${modal.options.resourceName}[${modal.options.addAttribute}][${ordinalNumber}][id]`, attachmentId)\n          details.appendChild(hiddenTitleField);\n          details.appendChild(hiddenIdField);\n        }\n        span.innerHTML = `${escapeHtml(title)} (${escapeHtml(truncateFilename(item.dataset.filename))})`;\n      } else {\n        span.innerHTML = escapeHtml(truncateFilename(item.dataset.filename, 19));\n      }\n      span.style.display = \"block\";\n    });\n\n    if (!modal.options.titled && modal.trashCan.children.length > 0) {\n      modal.activeAttachments.innerHTML = `<input name='${modal.options.resourceName}[remove_${modal.name}]' type=\"hidden\" value=\"true\">`;\n    }\n\n    if (validatedItemsCount > 0) {\n      // Foundation helper does some magic with error fields, so these must be triggered using jQuery.\n      const $el = $(modal.uploadContainer.querySelector(\"input[type='checkbox']\"));\n      if ($el) {\n        $el.prop(\"checked\", true);\n        $el.trigger(\"change\");\n      }\n    }\n    modal.cleanTrashCan();\n    modal.updateAddAttachmentsButton();\n  });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const attachmentButtons = document.querySelectorAll(\"button.add-file\");\n\n  attachmentButtons.forEach((attachmentButton) => {\n    const modal = new UploadModal(attachmentButton);\n    loadAttachments(modal);\n    addInputEventListener(modal);\n    addButtonEventListener(modal);\n    addDropZoneEventListeners(modal);\n    addSaveButtonEventListener(modal);\n  })\n})\n","/* eslint-disable require-jsdoc */\n\nimport lineBreakButtonHandler from \"src/decidim/editor/linebreak_module\";\nimport \"src/decidim/editor/clipboard_override\";\nimport \"src/decidim/vendor/image-resize.min\";\nimport \"src/decidim/vendor/image-upload.min\";\n\nconst quillFormats = [\n  \"bold\",\n  \"italic\",\n  \"link\",\n  \"underline\",\n  \"header\",\n  \"list\",\n  \"alt\",\n  \"break\",\n  \"width\",\n  \"style\",\n  \"code\",\n  \"blockquote\",\n  \"indent\"\n];\n\nexport default function createQuillEditor(container) {\n  const toolbar = $(container).data(\"toolbar\");\n  const disabled = $(container).data(\"disabled\");\n\n  const allowedEmptyContentSelector = \"iframe\";\n  let quillToolbar = [\n    [\"bold\", \"italic\", \"underline\", \"linebreak\"],\n    [{ list: \"ordered\" }, { list: \"bullet\" }],\n    [\"link\", \"clean\"],\n    [\"code\", \"blockquote\"],\n    [{ indent: \"-1\" }, { indent: \"+1\" }]\n  ];\n\n  let addImage = false;\n  let addVideo = false;\n\n  /**\n   * - basic = only basic controls without titles\n   * - content = basic + headings\n   * - full = basic + headings + image + video\n   */\n  if (toolbar === \"content\") {\n    quillToolbar = [[{ header: [2, 3, 4, 5, 6, false] }], ...quillToolbar];\n  } else if (toolbar === \"full\") {\n    addImage = true;\n    addVideo = true;\n    quillToolbar = [\n      [{ header: [2, 3, 4, 5, 6, false] }],\n      ...quillToolbar,\n      [\"video\"],\n      [\"image\"]\n    ];\n  }\n\n  let modules = {\n    linebreak: {},\n    toolbar: {\n      container: quillToolbar,\n      handlers: {\n        linebreak: lineBreakButtonHandler\n      }\n    }\n  };\n  const $input = $(container).siblings('input[type=\"hidden\"]');\n  container.innerHTML = $input.val() || \"\";\n  const token = $('meta[name=\"csrf-token\"]').attr(\"content\");\n\n  if (addVideo) {\n    quillFormats.push(\"video\");\n  }\n\n  if (addImage) {\n    // Attempt to allow images only if the image support is enabled at editor support.\n    // see: https://github.com/quilljs/quill/issues/1108\n    quillFormats.push(\"image\");\n\n    modules.imageResize = {\n      modules: [\"Resize\", \"DisplaySize\"]\n    };\n    modules.imageUpload = {\n      url: $(container).data(\"uploadImagesPath\"),\n      method: \"POST\",\n      name: \"image\",\n      withCredentials: false,\n      headers: { \"X-CSRF-Token\": token },\n      callbackOK: (serverResponse, next) => {\n        $(\"div.ql-toolbar\").last().removeClass(\"editor-loading\");\n        next(serverResponse.url);\n      },\n      callbackKO: (serverError) => {\n        $(\"div.ql-toolbar\").last().removeClass(\"editor-loading\");\n        console.log(`Image upload error: ${serverError.message}`);\n      },\n      checkBeforeSend: (file, next) => {\n        $(\"div.ql-toolbar\").last().addClass(\"editor-loading\");\n        next(file);\n      }\n    };\n\n    const text = $(container).data(\"dragAndDropHelpText\");\n    $(container).after(\n      `<p class=\"help-text\" style=\"margin-top:-1.5rem;\">${text}</p>`\n    );\n  }\n  const quill = new Quill(container, {\n    modules: modules,\n    formats: quillFormats,\n    theme: \"snow\"\n  });\n\n  if (addImage === false) {\n    // Firefox natively implements image drop in contenteditable which is why we need to disable that\n    quill.root.addEventListener(\"drop\", (ev) => ev.preventDefault());\n  }\n\n  if (disabled) {\n    quill.disable();\n  }\n\n  quill.on(\"text-change\", () => {\n    const text = quill.getText();\n\n    // Triggers CustomEvent with the cursor position\n    // It is required in input_mentions.js\n    let event = new CustomEvent(\"quill-position\", {\n      detail: quill.getSelection()\n    });\n    container.dispatchEvent(event);\n\n    if (\n      (text === \"\\n\" || text === \"\\n\\n\") &&\n      quill.root.querySelectorAll(allowedEmptyContentSelector).length === 0\n    ) {\n      $input.val(\"\");\n    } else {\n      const emptyParagraph = \"<p><br></p>\";\n      const cleanHTML = quill.root.innerHTML.replace(\n        new RegExp(`^${emptyParagraph}|${emptyParagraph}$`, \"g\"),\n        \"\"\n      );\n      $input.val(cleanHTML);\n    }\n  });\n  // After editor is ready, linebreak_module deletes two extraneous new lines\n  quill.emitter.emit(\"editor-ready\");\n\n  return quill;\n}\n","/* eslint-disable require-jsdoc */\n\nimport addEnterBindings from \"src/decidim/editor/modified_enter\"\nimport backspaceBindingsRangeAny from \"src/decidim/editor/modified_backspace_offset_any\"\nimport backspaceBindings from \"src/decidim/editor/modified_backspace_offset1\"\nimport HistoryOverride from \"src/decidim/editor/history_override\"\n\n// Disable warning messages from overwritting modules\nQuill.debug(\"error\");\n\n// It all started with these snippets of code: https://github.com/quilljs/quill/issues/252\nconst Delta = Quill.import(\"delta\");\nconst Break = Quill.import(\"blots/break\");\nconst Embed = Quill.import(\"blots/embed\");\nconst Scroll = Quill.import(\"blots/scroll\");\nconst Parchment = Quill.import(\"parchment\");\nQuill.register({\"modules/history\": HistoryOverride}, true);\nlet icons = Quill.import(\"ui/icons\");\nicons.linebreak = \"⏎\";\n\nclass SmartBreak extends Break {\n  length() {\n    return 1;\n  }\n\n  value() {\n    return \"\\n\";\n  }\n\n  insertInto(parent, ref) {\n    // Embed.prototype.insertInto.call(this, parent, ref);\n    Reflect.apply(Embed.prototype.insertInto, this, [parent, ref]);\n  }\n}\nQuill.register(SmartBreak);\n\n// Override quill/blots/scroll.js\nclass ScrollOvderride extends Scroll {\n  optimize(mutations = [], context = {}) {\n    if (this.batch === true) {\n      return;\n    }\n\n    this.parchmentOptimize(mutations, context);\n\n    if (mutations.length > 0) {\n      // quill/core/emitter.js, Emitter.events.SCROLL_OPTIMIZE = \"scroll-optimize\"\n      this.emitter.emit(\"scroll-optimize\", mutations, context);\n    }\n  }\n\n  // Override parchment/src/blot/scroll.ts\n  parchmentOptimize(mutations = [], context = {}) {\n    // super.optimize(context);\n    Reflect.apply(Parchment.Container.prototype.optimize, this, [context]);\n\n    // We must modify mutations directly, cannot make copy and then modify\n    // let records = [].slice.call(this.observer.takeRecords());\n    let records = [...this.observer.takeRecords()];\n    // Array.push currently seems to be implemented by a non-tail recursive function\n    // so we cannot just mutations.push.apply(mutations, this.observer.takeRecords());\n    while (records.length > 0) {\n      mutations.push(records.pop());\n    }\n    let mark = (blot, markParent) => {\n      if (!blot || blot === this) {\n        return;\n      }\n      if (!blot.domNode.parentNode) {\n        return;\n      }\n      if (blot.domNode.__blot && blot.domNode.__blot.mutations === null) {\n        blot.domNode.__blot.mutations = [];\n      }\n      if (markParent) {\n        mark(blot.parent);\n      }\n    };\n    let optimize = (blot) => {\n      // Post-order traversal\n      if (!blot.domNode.__blot) {\n        return;\n      }\n\n      if (blot instanceof Parchment.Container) {\n        blot.children.forEach(optimize);\n      }\n      blot.optimize(context);\n    };\n    let remaining = mutations;\n    for (let ind = 0; remaining.length > 0; ind += 1) {\n      // MAX_OPTIMIZE_ITERATIONS = 100\n      if (ind >= 100) {\n        throw new Error(\"[Parchment] Maximum optimize iterations reached\");\n      }\n      remaining.forEach((mutation) => {\n        let blot = Parchment.find(mutation.target, true);\n        if (!blot) {\n          return;\n        }\n        if (blot.domNode === mutation.target) {\n          if (mutation.type === \"childList\") {\n            mark(Parchment.find(mutation.previousSibling, false));\n\n            mutation.addedNodes.forEach((node) => {\n              let child = Parchment.find(node, false);\n              mark(child, false);\n              if (child instanceof Parchment.Container) {\n                child.children.forEach(function(grandChild) {\n                  mark(grandChild, false);\n                });\n              }\n            });\n          } else if (mutation.type === \"attributes\") {\n            mark(blot.prev);\n          }\n        }\n        mark(blot);\n      });\n      this.children.forEach(optimize);\n      remaining = [...this.observer.takeRecords()];\n      records = remaining.slice();\n      while (records.length > 0) {\n        mutations.push(records.pop());\n      }\n    }\n  }\n};\nQuill.register(\"blots/scroll\", ScrollOvderride, true);\nParchment.register(ScrollOvderride);\n\nexport default function lineBreakButtonHandler(quill) {\n  let range = quill.selection.getRange()[0];\n  let currentLeaf = quill.getLeaf(range.index)[0];\n  let nextLeaf = quill.getLeaf(range.index + 1)[0];\n  const previousChar = quill.getText(range.index - 1, 1);\n\n  // Insert a second break if:\n  // At the end of the editor, OR next leaf has a different parent (<p>)\n  if (nextLeaf === null || (currentLeaf.parent !== nextLeaf.parent)) {\n    quill.insertEmbed(range.index, \"break\", true, \"user\");\n    quill.insertEmbed(range.index, \"break\", true, \"user\");\n  } else if (previousChar === \"\\n\") {\n    const delta = new Delta().retain(range.index).insert(\"\\n\");\n    quill.updateContents(delta, Quill.sources.USER);\n  } else {\n    quill.insertEmbed(range.index, \"break\", true, \"user\");\n  }\n\n  // Now that we've inserted a line break, move the cursor forward\n  quill.setSelection(range.index + 1, Quill.sources.SILENT);\n}\n\nQuill.register(\"modules/linebreak\", (quill) => {\n  quill.getModule(\"toolbar\").addHandler(\"linebreak\", () => {\n    lineBreakButtonHandler(quill);\n  });\n\n  quill.emitter.on(\"editor-ready\", () => {\n    const length = quill.getLength();\n    const text = quill.getText(length - 2, 2);\n\n    // Remove extraneous new lines\n    if (text === \"\\n\\n\") {\n      quill.deleteText(quill.getLength() - 2, 2);\n    }\n  });\n\n  addEnterBindings(quill);\n  backspaceBindingsRangeAny(quill);\n  backspaceBindings(quill);\n\n  return;\n});\n\n","import \"bootstrap-tagsinput\"\n\n$(() => {\n  const $tagContainer = $(\".js-tags-container\");\n\n  // Initialize\n  $tagContainer.tagsinput({\n    tagClass: \"input__tag\",\n    trimValue: true\n  });\n\n});\n"],"names":["Configuration","_classCallCheck","this","config","key","value","arguments","length","undefined","_typeof","_objectSpread","TEMPLATE_HTML","ConfirmDialog","sourceElement","$modal","$","$source","$content","$buttonConfirm","$buttonCancel","titleId","concat","Math","random","toString","substring","removeAttr","attr","append","foundation","message","_this","html","off","Promise","resolve","on","ev","preventDefault","focus","remove","handleConfirm","element","data","Rails","outerHTML","confirm","then","answer","completed","type","is","parents","submit","origEv","originalEvent","newEv","Event","constructor","target","dispatchEvent","allowAction","getMatchingEventTarget","selector","Element","parentNode","handleDocumentEvent","matchSelectors","some","currentSelector","document","addEventListener","Uploader","modal","uploadItem","options","progressBar","querySelector","validationSent","fileTooBig","maxFileSize","file","size","showError","locales","file_size_too_large","upload","DirectUpload","url","errors","classList","add","innerHTML","validation_error","dataset","state","errorList","forEach","error","errorItem","createElement","appendChild","blobId","property","addAttribute","titled","input","uploadValidationsUrl","params","URLSearchParams","resourceClass","blob","formClass","formObjectClass","fetch","method","headers","response","json","_i","_Object$entries","Object","entries","_slicedToArray","style","justifyContent","uploaded","callback","request","_this2","event","progress","floor","loaded","total","width","validating","truncateFilename","filename","maxLength","charactersFromBegin","charactersFromEnd","slice","createHiddenInput","elClasses","elName","elValue","el","className","join","name","escapeHtml","text","createTextNode","UploadModal","button","providedOptions","JSON","parse","_e","assign","open","saveButton","attachmentCounter","dropZoneEnabled","modalTitle","uploadItems","dropZone","uploadContainer","activeAttachments","trashCan","createTrashCan","title","split","createUploadItem","uploader","directUploadUrl","attachmentName","create","console","ordinalNumber","getOrdinalNumber","attachmentDetails","fileid","titleAndFileNameSpan","display","hiddenBlobField","signed_id","resourceName","hiddenTitleField","multiple","cleanTrashCan","validate","updateDropZone","nextOrdinalNumber","children","disabled","fileName","_fileNameSpan$classLi","wrapper","setAttribute","firstRow","secondRow","thirdRow","fileNameSpan","fileNameSpanClasses","push","apply","progressBarBorder","progressBarWrapper","removeButton","titleInputContainer","titleInput","parentElement","everyItemHasTitle","Array","from","item","noTitleErrorSpan","role","title_required","titleLabelSpan","titleContainer","addlabel","editlabel","_this3","fileId","activeAttachment","querySelectorAll","attachmentButton","child","loadAttachments","files","uploadFile","addInputEventListener","addButtonEventListener","dataTransfer","addDropZoneEventListeners","validatedItems","validatedItemsCount","details","span","hiddenTitle","attachmentId","hiddenIdField","$el","prop","trigger","updateAddAttachmentsButton","addSaveButtonEventListener","quillFormats","createQuillEditor","container","toolbar","quillToolbar","list","indent","addImage","addVideo","header","_toConsumableArray","modules","linebreak","handlers","lineBreakButtonHandler","$input","siblings","val","token","imageResize","imageUpload","withCredentials","callbackOK","serverResponse","next","last","removeClass","callbackKO","serverError","log","checkBeforeSend","addClass","after","quill","Quill","formats","theme","root","disable","getText","CustomEvent","detail","getSelection","emptyParagraph","cleanHTML","replace","RegExp","emitter","emit","debug","Delta","Break","Embed","Scroll","Parchment","register","HistoryOverride","SmartBreak","_Break","_inherits","_super","_createSuper","_createClass","parent","ref","Reflect","prototype","insertInto","ScrollOvderride","_Scroll","_super2","mutations","context","batch","parchmentOptimize","Container","optimize","records","observer","takeRecords","pop","mark","blot","markParent","domNode","__blot","remaining","ind","Error","mutation","find","previousSibling","addedNodes","node","grandChild","prev","range","selection","getRange","currentLeaf","getLeaf","index","nextLeaf","previousChar","insertEmbed","delta","retain","insert","updateContents","sources","USER","setSelection","SILENT","getModule","addHandler","getLength","deleteText","addEnterBindings","backspaceBindingsRangeAny","backspaceBindings","tagsinput","tagClass","trimValue"],"sourceRoot":""}